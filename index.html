<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" href="node_modules/bulma/css/bulma.min.css">
<style>
  #charttable {
    width: 100%;
  }
  .table td, .table th {
    padding: 0;
    padding-top: 1em;
    border-width: 1px;
    border-color: transparent;
  }
  .currentColor {
    width: 100px;
    height: 100px;
    display: block;
  }
  .currentTime {
    border: 1px solid #ff00ff !important;
  }
  .color0 { background-color: #f3fdff; }
  .color1 { background-color: #e8f7fe; }
  .color2 { background-color: #d2ecfd; }
  .color3 { background-color: #a5d9f6; }
  .color4 { background-color: #60bdf6; }
  .color5 { background-color: #1da1f3; }
  .color6 { background-color: #1674b1; }
  .color7 { background-color: #0b344f; }
</style>
</head>
<body>

<section id="hero" class="hero is-fullheight">
  <div class="hero-body">
    <div class="container has-text-centered">
      <div class="column is-6 is-offset-3">
          <h1 class="title">Coming Soon</h1>
          <h2 class="subtitle">$this is the best software platform for running an internet business. We handle billions of dollars every year for forward-thinking businesses around the world.</h2>
          <div class="box">
            <table id="charttable" class="table"></table>
          </div>
      </div>
    </div>
  </div>
</section>

<script>
let twitter_media = [
  [0,0,0,0,1,2,3,3,4,5,5,4,5,5,3,3,3,2,2,2,2,3,2,0], // Mon
  [1,1,1,1,2,1,2,3,5,6,5,5,5,4,4,3,3,3,2,2,2,2,0,0], // Tues
  [1,1,1,2,2,3,4,6,7,6,5,6,6,4,3,4,4,4,4,3,3,3,0,0], // Wed
  [1,1,1,1,1,2,3,5,6,7,6,6,5,4,4,4,6,6,4,3,7,2,4,3], // Thurs
  [3,3,3,3,3,4,5,6,6,6,6,6,5,5,4,3,3,2,2,2,2,2,0,0], // Fri
  [1,1,0,1,1,2,2,2,2,4,4,4,3,3,3,3,2,2,2,2,2,1,1,1], // Sat
  [1,1,1,1,1,2,4,5,4,5,5,4,3,3,3,3,2,2,2,2,2,2,0,0]  // Sun
];

function getChartTableHTML(current_media, day_index, hour_index) {
  let htmlstring = "";
  for (let i=0; i<current_media.length; i++) {
    htmlstring += "<tr>";
    for (let j=0; j<current_media[i].length; j++) {
      if ((i == day_index) && (j == hour_index)) {
        htmlstring += "<td class='square currentTime color" + current_media[i][j] + "'></td>";
      } else {
        htmlstring += "<td class='square color" + current_media[i][j] + "'></td>";
      }
    }
    htmlstring += "</tr>";
  }
  return htmlstring;
}

function getCurrentColorClass(current_media, day_index, hour_index) {
  return "color" + current_media[day_index][hour_index]
}

function recreatePage(current_media, day_index, hour_index) {
  document.getElementById("hero").classList.add(getCurrentColorClass(current_media, day_index, hour_index));
  document.getElementById("charttable").innerHTML = getChartTableHTML(current_media, day_index, hour_index);
}

function getCurrentIndices() {
  var todayCST = new Date().toLocaleString("en-US", {
    timeZone: "America/Chicago"
  });
  todayCST = new Date(todayCST);
  day_index = todayCST.getDay();
  // This behavior is due to the reference chart showing Sunday as the last day of the week and not the first.
  if (day_index == 0) {
    // Sunday gets changed to 6
    day_index = 6
  } else {
    // All other days need to have their index decreased by 1;
    day_index -= 1;
  }
  hour_index = todayCST.getHours();
  return [day_index, hour_index];
}

let indices = getCurrentIndices();
recreatePage(twitter_media, indices[0], indices[1]);
</script>

</body>
</html>
